
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>Performance Test in Xcode  | Sameh Mabrouk</title>

	<meta name="author" content="Sameh Mabrouk">

<meta name="description" content="Yesterday i recieved a JIRA issue from QA that the iOS application is very slow apparently the issue was in application services(API) being very slow &hellip;"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Sameh Mabrouk" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	

</head>



<body>
	<header id="header" class="inner"><h1><a href="/">Sameh Mabrouk</a></h1>
<span class="tagline"></span>
<nav id="main-nav"><ul class="main-nav">
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</nav> 
<nav id="mobile-nav">
 	<div class="alignleft menu"> 
 		<a class="button">Menu</a> 
 		<div class="container"><ul class="main-nav">
	<li><a href="/">Blog</a></li>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
</ul>
</div> 
 	</div> 
 </nav> 


</header>

	<div id="content" class="inner"><article class="post">
	<header>
		
		<h2 class="title">Performance Test in Xcode</h2>
		
		<div class="meta date">



<time class='entry-date' datetime='2015-08-27T02:48:33+02:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span></time></div>
	</header>

	<div class="entry-content"><p>Yesterday i recieved a JIRA issue from QA that the iOS application is very slow apparently the issue was in application services(API) being very slow to perform any operation.
I started to investigate in the issue and there was a use case that the user select a file then there was a 2 API that should be called to process this file to be previewed in PDF previewer, So i started to think about a way to calculate the time the process it takes starting from selecting the file untile it&rsquo;s previewed. i eneded up with profiling and therfore i did some research on how to do a profiling in Xcode and i found that Xcode has an addition to unit testing it provide the ability to measure the performance of a piece of code. This allow developers to gain insight into the specific timing infotmation of the code that being tested.</p>

<h2>Performance Testing</h2>

<p>With performance testing you can know the average time of execution for a piece of code. Also you can define a baseline exection time. This means that if the code that&rsquo;s being testd deviates from that baseline, the test fails. Xcode will repeatedly execute the code 10 times and measure the average execution time. To measure the measure the performance of a piece of code, use the &ldquo;measureBlock:&rdquo; API.
This is one of the test cases i prepared:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">testPerformanceExample</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// This is an example of a performance test case.</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span> <span class="nl">measureBlock</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
</span><span class='line'>        <span class="c1">// Put the code you want to measure the time of here.</span>
</span><span class='line'>        <span class="n">XCTestExpectation</span> <span class="o">*</span><span class="n">completionExpectation</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">expectationWithDescription</span><span class="p">:</span><span class="s">@&quot;Long method&quot;</span><span class="p">];</span>
</span><span class='line'>        <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">vcToTest</span> <span class="nl">doConvertFile</span><span class="p">:</span><span class="s">@&quot;&quot;</span> <span class="nl">withBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">XCTAssertEqualObjects</span><span class="p">(</span><span class="s">@&quot;success&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s">@&quot;Result was not correct!&quot;</span><span class="p">);</span>
</span><span class='line'>            <span class="p">[</span><span class="n">completionExpectation</span> <span class="n">fulfill</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}];</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">[</span><span class="nb">self</span> <span class="nl">waitForExpectationsWithTimeout</span><span class="p">:</span><span class="mf">100.0</span> <span class="nl">handler</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>But what is XCTestExpectation in this block of code, Right this is a class that enable you to test Asyncronous code. The flow to test Asynchronous code is as follows, define an expectaion, wait for the expectation to be fulfilled, and fulfill the expectation when the asyncronous code finsish executing.</p>

<p>Then i started to run the above test in Xcode and this was the result:
<img class="left" src="images/performance_test_result.png" title="#2" ></p>

<p>Now you can edit the baseline time of execution for the performance test.</p>
</div>


	
	</article>

	
	<div class="share">
	  <!-- <ul> -->
	  <!--   <li>
  <a href="https://twitter.com/intent/tweet?text=Performance Test in Xcode by @&url=http://isame7.github.io/blog/2015/08/27/performance-test-in-xcode/" title="Share Performance Test in Xcode on Twitter">
    <img src="/images/social/twitter.png" />
  </a>
</li>
 -->
	  <!--   <li>
  <a href="https://www.facebook.com/sharer.php?u=http://isame7.github.io/blog/2015/08/27/performance-test-in-xcode/" title="Share Performance Test in Xcode on Facebook">
    <img src="/images/social/facebook.png" />
  </a>
</li>
 -->
	  <!--   <li>
  <a href="https://plus.google.com/share?url=http://isame7.github.io/blog/2015/08/27/performance-test-in-xcode/" title="Share Performance Test in Xcode on Google Plus">
    <img src="/images/social/google.png" />
  </a>
</li>
 -->
	  <!-- </ul> -->
	</div>



</div>
	<footer id="footer" class="inner"><br>
<br>
<br>
<br>
&copy; 2015

    Sameh Mabrouk

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/hyphenator.js"></script>







</body>
<script>
  $(document).ready(function() {
  // Make images center
  $('p:has(img)').css('text-align', 'center');
  });
</script>
</html>
